<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Narendra Jadaun | Senior Visual Designer</title>
    <meta name="description" content="Portfolio of Narendra Jadaun, Senior Graphics Designer & Video Editor.">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600&family=Syne:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <script src="https://unpkg.com/phosphor-icons"></script>

    <!-- Custom CSS -->
    <style>
        :root {
            --primary: #ffffff;
            --secondary: #888888;
            --bg: #050505;
            --accent: #FF3B30;
            --behance: #0057ff;
        }

        body {
            background-color: var(--bg);
            color: var(--primary);
            font-family: 'Space Grotesk', sans-serif;
            overflow-x: hidden;
            cursor: none; /* Hide default cursor */
            margin: 0;
            padding: 0;
        }

        /* Re-enable default cursor for touch devices */
        @media (hover: none) and (pointer: coarse) {
            body {
                cursor: auto;
            }
            .cursor-dot, .cursor-outline {
                display: none;
            }
        }

        h1, h2, h3, h4, .font-display {
            font-family: 'Syne', sans-serif;
        }

        /* Custom Cursor */
        .cursor-dot,
        .cursor-outline {
            position: fixed;
            top: 0;
            left: 0;
            transform: translate(-50%, -50%);
            border-radius: 50%;
            z-index: 9999;
            pointer-events: none;
        }

        .cursor-dot {
            width: 8px;
            height: 8px;
            background-color: white;
        }

        .cursor-outline {
            width: 40px;
            height: 40px;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        body.hovering .cursor-outline {
            width: 60px;
            height: 60px;
            background-color: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(2px);
            border-color: transparent;
        }

        /* Canvas Background */
        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: -1;
            opacity: 0.4;
            pointer-events: none;
        }

        /* Utilities */
        .glass-panel {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: border-color 0.3s ease, background-color 0.3s ease;
        }
        
        .glass-panel:hover {
            border-color: rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.05);
        }
        
        .glass-panel-accent {
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .marquee-container {
            overflow: hidden;
            white-space: nowrap;
        }
        
        .marquee-content {
            display: inline-block;
            animation: marquee 20s linear infinite;
        }

        @keyframes marquee {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }

        /* Loader */
        .loader {
            position: fixed;
            inset: 0;
            background: #000;
            z-index: 10000;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
        }

        .loader-bar {
            width: 200px;
            height: 2px;
            background: #333;
            margin-top: 20px;
            position: relative;
            overflow: hidden;
        }

        .loader-progress {
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: 0%;
            background: #fff;
        }
        
        /* Smooth reveal classes */
        .reveal-up {
            opacity: 0;
            transform: translateY(50px);
        }
        
        .line-wrapper {
            overflow: hidden;
        }
        
        .line-text {
            display: block; 
            /* Removed initial transform that hid the text */
        }

        /* AI Lab Styles */
        .ai-input:focus {
            outline: none;
            border-color: white;
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.1);
        }
        
        .color-swatch {
            transition: transform 0.3s ease;
        }
        .color-swatch:hover {
            transform: scale(1.1);
        }
        
        .glowing-btn {
            position: relative;
            overflow: hidden;
        }
        .glowing-btn::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 60%);
            opacity: 0;
            transform: scale(0.5);
            transition: opacity 0.3s, transform 0.3s;
        }
        .glowing-btn:hover::after {
            opacity: 1;
            transform: scale(1);
        }

        /* Tab Switcher */
        .lab-tab {
            cursor: pointer;
            padding: 10px 20px;
            border-radius: 99px;
            border: 1px solid transparent;
            transition: all 0.3s ease;
            opacity: 0.6;
        }
        .lab-tab.active {
            background: white;
            color: black;
            opacity: 1;
            font-weight: bold;
        }
        .lab-tab:not(.active):hover {
            border-color: rgba(255,255,255,0.3);
            opacity: 1;
        }

        /* Chatbot Styles */
        #chat-widget {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 9998;
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: 10px;
        }
        #chat-window {
            width: 320px;
            height: 450px;
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            transform-origin: bottom right;
            transform: scale(0);
            opacity: 0;
            transition: transform 0.3s cubic-bezier(0.19, 1, 0.22, 1), opacity 0.3s ease;
            box-shadow: 0 10px 40px rgba(0,0,0,0.5);
        }
        /* Mobile Chat Window Adjustment */
        @media (max-width: 640px) {
            #chat-window {
                width: 90vw;
                height: 60vh;
                position: fixed;
                bottom: 80px;
                right: 5vw;
            }
        }
        #chat-window.open {
            transform: scale(1);
            opacity: 1;
        }
        #chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 16px;
            display: flex;
            flex-direction: column;
            gap: 12px;
            font-size: 0.9rem;
        }
        .message {
            max-width: 80%;
            padding: 10px 14px;
            border-radius: 12px;
            line-height: 1.4;
        }
        .message.user {
            align-self: flex-end;
            background: white;
            color: black;
            border-bottom-right-radius: 2px;
        }
        .message.bot {
            align-self: flex-start;
            background: rgba(255,255,255,0.1);
            color: white;
            border-bottom-left-radius: 2px;
            border: 1px solid rgba(255,255,255,0.05);
        }
        #chat-toggle {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: white;
            color: black;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 0 20px rgba(255,255,255,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        #chat-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 0 30px rgba(255,255,255,0.4);
        }

        /* Image Gen */
        .generated-image-container {
            position: relative;
            overflow: hidden;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
            aspect-ratio: 16/9;
            margin-top: 1rem;
            background: #000;
        }
        .generated-image-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        .generated-image-container:hover img {
            transform: scale(1.05);
        }
        
        .logo-container {
            aspect-ratio: 1/1; 
            border: 1px solid rgba(255,255,255,0.1); 
            border-radius: 12px; 
            overflow: hidden;
            background: #111;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* New Animation Keyframes */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fadeIn 0.8s ease-out forwards;
        }

        /* TOAST NOTIFICATION */
        #toast {
            visibility: hidden;
            min-width: 280px;
            background-color: rgba(20, 20, 20, 0.95);
            color: #fff;
            text-align: center;
            border-radius: 50px;
            padding: 16px 24px;
            position: fixed;
            z-index: 10000;
            left: 50%;
            bottom: 30px;
            transform: translateX(-50%);
            font-size: 16px;
            font-weight: 500;
            opacity: 0;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        #toast.show {
            visibility: visible;
            opacity: 1;
            bottom: 50px;
        }

        /* Mobile Menu */
        #mobile-menu {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: #000;
            z-index: 9990;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            gap: 2rem;
            transform: translateY(-100%);
            transition: transform 0.5s cubic-bezier(0.77, 0, 0.175, 1);
        }
        #mobile-menu.open {
            transform: translateY(0);
        }

    </style>
</head>
<body class="antialiased selection:bg-white selection:text-black">

    <!-- Preloader -->
    <div class="loader">
        <h1 class="font-display text-4xl md:text-6xl font-bold tracking-tighter text-white">
            <span class="counter">0</span>%
        </h1>
        <div class="loader-bar">
            <div class="loader-progress"></div>
        </div>
    </div>

    <!-- Custom Cursor Elements (Hidden on touch devices via CSS) -->
    <div class="cursor-dot"></div>
    <div class="cursor-outline"></div>

    <!-- 3D Background -->
    <div id="canvas-container"></div>

    <!-- Navigation -->
    <!-- UPDATED: Added background, blur, and border. Removed mix-blend-difference to fix scrolling overlap. -->
    <nav class="fixed top-0 w-full z-[100] px-6 py-4 md:px-12 md:py-6 flex justify-between items-center bg-black/90 backdrop-blur-md border-b border-white/10 text-white transition-all duration-300">
        <a href="#" class="font-display text-2xl font-bold tracking-tight hover-trigger z-50" data-hover-text="Home">NJ.</a>
        
        <!-- Desktop Menu -->
        <div class="hidden md:flex gap-4 text-xs font-bold uppercase tracking-widest items-center">
            <a href="#about" class="hover:text-gray-400 transition-colors hover-trigger">About</a>
            <a href="#services" class="hover:text-gray-400 transition-colors hover-trigger">Services</a>
            
            <a href="#work" class="px-5 py-2 border border-white/20 rounded-full hover:bg-white/10 transition-all hover-trigger flex items-center gap-2">
                View My Work
            </a>

            <a href="https://www.behance.net/narendrajadaun" target="_blank" class="bg-[#0057ff] text-white px-5 py-2 rounded-full hover:bg-blue-600 transition-all hover-trigger flex items-center gap-2 shadow-lg shadow-blue-900/50">
                <i class="ph-bold ph-behance-logo text-lg"></i> Behance
            </a>

            <a href="https://drive.google.com/uc?export=download&id=12Gw46VRkNcrGBFWmStEoz_kfW05HzRPD" class="px-5 py-2 border border-white/20 rounded-full hover:bg-white hover:text-black transition-all hover-trigger flex items-center gap-2">
                <i class="ph-bold ph-download-simple"></i> CV
            </a>
            
            <a href="#contact" class="px-5 py-2 bg-white text-black rounded-full hover:bg-gray-200 transition-all hover-trigger">Contact</a>
        </div>

        <!-- Mobile Menu Button -->
        <button class="md:hidden text-2xl hover-trigger z-50 focus:outline-none text-white" onclick="toggleMobileMenu()">
            <i class="ph ph-list" id="menu-icon"></i>
        </button>
    </nav>

    <!-- Mobile Fullscreen Menu -->
    <div id="mobile-menu">
        <a href="#about" class="text-3xl font-display font-bold text-white hover:text-gray-400 transition-colors" onclick="toggleMobileMenu()">About</a>
        <a href="#services" class="text-3xl font-display font-bold text-white hover:text-gray-400 transition-colors" onclick="toggleMobileMenu()">Services</a>
        <a href="#work" class="text-3xl font-display font-bold text-[#FF3B30] hover:text-white transition-colors" onclick="toggleMobileMenu()">View My Work</a>
        <a href="https://www.behance.net/narendrajadaun" target="_blank" class="text-3xl font-display font-bold text-[#0057ff] hover:text-white transition-colors">Behance Portfolio</a>
        <a href="https://drive.google.com/uc?export=download&id=12Gw46VRkNcrGBFWmStEoz_kfW05HzRPD" class="text-xl font-bold text-white border border-white/20 px-6 py-3 rounded-full hover:bg-white hover:text-black transition-colors">Download CV</a>
        <a href="#contact" class="text-xl font-bold bg-white text-black px-8 py-3 rounded-full hover:bg-gray-200 transition-colors" onclick="toggleMobileMenu()">Contact Me</a>
    </div>

    <!-- Main Content -->
    <main>
        
        <!-- Hero Section -->
        <section class="h-screen flex flex-col justify-center px-6 md:px-12 relative pt-20 overflow-hidden">
            <div class="absolute top-1/2 right-12 -translate-y-1/2 hidden lg:block opacity-20 pointer-events-none">
                <!-- Decorative Circle -->
                <div class="w-[500px] h-[500px] border border-white/20 rounded-full animate-[spin_20s_linear_infinite]"></div>
            </div>

            <div class="z-10 relative flex flex-col items-center justify-center w-full">
                <!-- RESTORED LAYOUT: Clean Solid White Text and Outline Text -->
                <div class="w-full text-center">
                    
                    <div class="line-wrapper overflow-hidden mb-2">
                        <h1 class="line-text font-display text-[12vw] leading-none font-bold uppercase tracking-tighter text-white">
                            Narendra
                        </h1>
                    </div>
                    
                    <div class="line-wrapper overflow-hidden">
                        <h1 class="line-text font-display text-[12vw] leading-none font-bold uppercase tracking-tighter text-transparent" style="-webkit-text-stroke: 2px white;">
                            Jadaun
                        </h1>
                    </div>

                </div>
                
                <div class="mt-8 md:mt-12 max-w-2xl reveal-up text-center px-4">
                    <p class="text-lg md:text-2xl text-gray-300 font-light leading-relaxed">
                        Senior Graphics Designer & Video Editor. Expert in <span class="text-white font-medium">Adobe Creative Suite</span> & <span class="text-white font-medium">Modern AI Tools</span>.
                    </p>
                </div>
            </div>

            <div class="absolute bottom-12 left-6 md:left-12 flex gap-4 animate-bounce">
                <i class="ph ph-arrow-down text-2xl"></i>
            </div>
        </section>

        <!-- Marquee Section -->
        <section class="py-12 bg-white text-black border-y border-gray-800 rotate-1 scale-105 z-20 relative">
            <div class="marquee-container font-display text-4xl md:text-6xl font-bold uppercase tracking-tight">
                <div class="marquee-content">
                    Strategy <span class="mx-4 text-gray-400">•</span> 
                    Branding <span class="mx-4 text-gray-400">•</span> 
                    Video Editing <span class="mx-4 text-gray-400">•</span> 
                    Print Design <span class="mx-4 text-gray-400">•</span> 
                    UI/UX <span class="mx-4 text-gray-400">•</span>
                    Strategy <span class="mx-4 text-gray-400">•</span> 
                    Branding <span class="mx-4 text-gray-400">•</span> 
                    Video Editing <span class="mx-4 text-gray-400">•</span> 
                    Print Design <span class="mx-4 text-gray-400">•</span> 
                    UI/UX <span class="mx-4 text-gray-400">•</span>
                </div>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="py-24 md:py-32 px-6 md:px-12 max-w-7xl mx-auto">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-16 items-center">
                <div class="reveal-up relative group">
                    <!-- Image Placeholder with hover effect -->
                    <div class="aspect-[3/4] overflow-hidden rounded-sm relative hover-trigger">
                        <!-- Updated User Image Link -->
                        <img src="https://lh3.googleusercontent.com/d/19j27wmPM0wz3TCdhxjo1tVwCnlqRkLKR" 
                             onerror="this.src='https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?q=80&w=1887&auto=format&fit=crop'"
                             alt="Narendra Jadaun" class="w-full h-full object-cover grayscale group-hover:grayscale-0 transition-all duration-700 scale-100 group-hover:scale-110">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent opacity-60"></div>
                        <div class="absolute bottom-6 left-6">
                            <p class="font-display text-2xl font-bold">6+ Years</p>
                            <p class="text-sm text-gray-400">Of Professional Excellence</p>
                        </div>
                    </div>
                    <!-- Floating Badge -->
                    <div class="absolute -top-10 -right-10 hidden md:flex w-32 h-32 bg-white text-black rounded-full items-center justify-center font-bold text-center text-xs uppercase p-4 animate-[spin_10s_linear_infinite]">
                        Open to New Projects
                    </div>
                </div>

                <div class="reveal-up">
                    <h2 class="font-display text-5xl md:text-7xl font-bold mb-8">About Me</h2>
                    <div class="mb-6 flex flex-wrap gap-4">
                         <button onclick="playBioTTS()" class="flex items-center gap-2 text-xs uppercase tracking-widest bg-white/10 hover:bg-white/20 border border-white/20 px-4 py-2 rounded-full transition-all hover-trigger group">
                            <i id="tts-icon" class="ph-fill ph-speaker-high text-lg group-hover:text-accent transition-colors"></i> 
                            <span id="tts-text">Listen to Bio ✨</span>
                        </button>
                        
                        <!-- Download CV Button -->
                        <a href="https://drive.google.com/uc?export=download&id=12Gw46VRkNcrGBFWmStEoz_kfW05HzRPD" class="flex items-center gap-2 text-xs uppercase tracking-widest bg-white/10 hover:bg-white/20 border border-white/20 px-4 py-2 rounded-full transition-all hover-trigger group">
                            <i class="ph-bold ph-file-pdf text-lg group-hover:text-accent transition-colors"></i>
                            <span>Download CV</span>
                        </a>
                    </div>
                    <p class="text-lg text-gray-400 mb-6 leading-relaxed" id="bio-text">
                        Experienced Graphics Designer and Video Editor with 6+ years of creating designs for books, logos, brochures, banners, websites, and product mockups. Skilled in Adobe Creative Suite, video editing, animation, and digital marketing. Focused on delivering creative and impactful designs that engage audiences and meet project goals.
                    </p>
                    <p class="text-lg text-gray-400 mb-10 leading-relaxed">
                        Currently at <strong class="text-white">Mittsure Technologies</strong>, I manage end-to-end design workflows. Previously freelance at <strong class="text-white">UBGOT It Solution Pvt. Ltd</strong>.
                    </p>
                    
                    <div class="grid grid-cols-2 gap-4">
                        <div class="glass-panel p-4 hover:bg-white/10 transition duration-300">
                            <h3 class="font-bold text-xl mb-1">Design</h3>
                            <p class="text-xs text-gray-400 uppercase">Photoshop • Illustrator • InDesign</p>
                        </div>
                        <div class="glass-panel p-4 hover:bg-white/10 transition duration-300">
                            <h3 class="font-bold text-xl mb-1">Video & Motion</h3>
                            <p class="text-xs text-gray-400 uppercase">After Effects • Premiere • Animate</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Selected Works (Parallax) -->
        <section id="work" class="py-24 md:py-32 bg-[#0a0a0a]">
            <div class="px-6 md:px-12 mb-16 flex flex-col md:flex-row justify-between items-start md:items-end gap-6">
                <div>
                    <h2 class="font-display text-4xl md:text-6xl font-bold">Selected Works</h2>
                    <p class="text-gray-400 mt-2">A curation of professional milestones</p>
                </div>
                <a href="https://www.behance.net/narendrajadaun" target="_blank" class="hidden md:inline-flex items-center gap-2 border-b border-white pb-1 hover:text-gray-300 transition hover-trigger">
                    View Full Behance Portfolio <i class="ph ph-arrow-right"></i>
                </a>
            </div>

            <div class="space-y-32 px-6 md:px-12 max-w-7xl mx-auto mb-32">
                <!-- Project 1: Mittsure Technologies -->
                <div class="group relative grid grid-cols-1 md:grid-cols-12 gap-8 items-center reveal-up">
                    <div class="md:col-span-8 overflow-hidden rounded-sm relative aspect-video hover-trigger">
                        <!-- Updated Image -->
                        <img src="https://images.unsplash.com/photo-1522202176988-66273c2fd55f?q=80&w=2671&auto=format&fit=crop" alt="Mittsure Educational Design" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                        <div class="absolute inset-0 bg-black/20 group-hover:bg-transparent transition duration-500"></div>
                    </div>
                    <div class="md:col-span-4 md:-ml-12 z-10">
                        <div class="glass-panel p-8 md:p-10 backdrop-blur-xl group-hover:bg-white/5 transition-colors duration-300">
                            <span class="text-xs font-bold text-gray-500 uppercase tracking-widest mb-2 block">Mittsure Technologies (2020 - Present)</span>
                            <h3 class="font-display text-3xl md:text-4xl font-bold mb-4">Future of Learning</h3>
                            <p class="text-gray-400 mb-6 text-sm">Conceptualized and designed a wide variety of graphics materials, including brochures, banners, books, and flyers. Delivered high-quality video editing and animation projects for educational content.</p>
                        </div>
                    </div>
                </div>

                <!-- Project 2: UBGOT It Solution -->
                <div class="group relative grid grid-cols-1 md:grid-cols-12 gap-8 items-center reveal-up">
                    <div class="md:col-span-4 order-2 md:order-1 md:-mr-12 z-10">
                        <div class="glass-panel p-8 md:p-10 backdrop-blur-xl text-right md:text-left group-hover:bg-white/5 transition-colors duration-300">
                            <span class="text-xs font-bold text-gray-500 uppercase tracking-widest mb-2 block">UBGOT Solutions (2018 - 2020)</span>
                            <h3 class="font-display text-3xl md:text-4xl font-bold mb-4">Brand & Digital</h3>
                            <p class="text-gray-400 mb-6 text-sm">Utilized Adobe Creative Suite to create professional designs including logos, websites, and advertisements. Managed digital marketing visuals to enhance brand visibility and engagement.</p>
                        </div>
                    </div>
                    <div class="md:col-span-8 order-1 md:order-2 overflow-hidden rounded-sm relative aspect-video hover-trigger">
                        <img src="https://images.unsplash.com/photo-1561070791-2526d30994b5?q=80&w=2000&auto=format&fit=crop" alt="Brand Identity Work" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                    </div>
                </div>

                <!-- Project 3: Advanced AI Tools -->
                <div class="group relative grid grid-cols-1 md:grid-cols-12 gap-8 items-center reveal-up">
                    <!-- Video Container -->
                    <div class="md:col-span-8 overflow-hidden rounded-sm relative aspect-video hover-trigger">
                        <!-- YouTube Embed as Cover Video -->
                        <div class="w-full h-full aspect-video bg-black relative overflow-hidden">
                            <iframe 
                                src="https://www.youtube.com/embed/gtydhVUleBE?autoplay=1&mute=1&controls=0&loop=1&playlist=gtydhVUleBE&playsinline=1&rel=0&modestbranding=1&enablejsapi=1" 
                                class="absolute top-1/2 left-1/2 w-[160%] h-[160%] -translate-x-1/2 -translate-y-1/2 pointer-events-none" 
                                title="AI Generated Video"
                                frameborder="0" 
                                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                                allowfullscreen>
                            </iframe>
                            
                            <!-- Overlay Gradient for text readability if needed -->
                            <div class="absolute inset-0 bg-gradient-to-t from-black/20 via-transparent to-transparent pointer-events-none"></div>

                            <!-- Decorative Icon -->
                             <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                                <div class="w-16 h-16 rounded-full bg-white/10 backdrop-blur-sm flex items-center justify-center border border-white/20">
                                    <i class="ph-fill ph-sparkle text-2xl text-white"></i>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Text Content: UPDATED to separate layout without overlap -->
                    <div class="md:col-span-4 z-10">
                        <div class="glass-panel p-8 md:p-10 backdrop-blur-xl group-hover:bg-white/5 transition-colors duration-300">
                            <span class="text-xs font-bold text-gray-500 uppercase tracking-widest mb-2 block">AI Innovation</span>
                            <h3 class="font-display text-3xl md:text-4xl font-bold mb-4">AI Arsenal</h3>
                            <p class="text-gray-400 mb-6 text-sm">Pushing creative boundaries with the latest generative models. My workflow integrates <strong>Nano Banana</strong> and <strong>Midjourney</strong> for high-fidelity concepts, <strong>Veo</strong> and <strong>Runway</strong> for cinematic video synthesis, and <strong>Flow</strong> for complex design automation.</p>
                            <!-- NEW LINK TO TOOL -->
                            <button onclick="switchToAdvisor()" class="mt-4 inline-flex items-center gap-2 text-sm font-bold text-[#FF3B30] uppercase hover:gap-3 transition-all">
                                Get AI Advice <i class="ph-bold ph-magic-wand"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- THE BIG BEHANCE TAB -->
            <div class="reveal-up px-6 md:px-12 text-center w-full">
                <a href="https://www.behance.net/narendrajadaun" target="_blank" 
                   class="group relative inline-flex items-center justify-center gap-4 px-8 md:px-12 py-8 md:py-10 w-full md:w-auto bg-[#0057ff] rounded-2xl overflow-hidden hover:scale-[1.02] transition-transform duration-500 shadow-[0_0_50px_rgba(0,87,255,0.3)] hover:shadow-[0_0_100px_rgba(0,87,255,0.6)]">
                    
                    <!-- Animated background glow -->
                    <div class="absolute inset-0 bg-gradient-to-r from-blue-600 via-[#0057ff] to-blue-400 opacity-80 group-hover:opacity-100 transition-opacity duration-500"></div>
                    <div class="absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20"></div>
                    
                    <div class="relative z-10 flex flex-col items-center">
                        <span class="text-white font-display text-3xl md:text-6xl font-bold uppercase tracking-tight text-center">View My Work</span>
                        <span class="text-blue-100 text-xs md:text-lg font-bold tracking-[0.2em] mt-2 flex items-center gap-3">
                            <i class="ph-bold ph-behance-logo text-lg md:text-2xl"></i> OPEN FULL PORTFOLIO
                        </span>
                    </div>
                    
                    <!-- Arrow Icon -->
                    <div class="absolute right-4 md:right-8 top-1/2 -translate-y-1/2 opacity-0 md:opacity-100 group-hover:translate-x-2 transition-transform duration-300">
                         <i class="ph-bold ph-arrow-right text-3xl md:text-5xl text-white/80"></i>
                    </div>
                </a>
            </div>
        </section>

        <!-- AI CREATIVE SUITE SECTION -->
        <section id="ai-lab" class="py-24 md:py-32 px-6 md:px-12 relative overflow-hidden bg-black/90">
             <div class="absolute top-0 left-0 w-full h-full bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-10 pointer-events-none"></div>
             <!-- Mesh Gradient -->
             <div class="absolute top-1/4 right-0 w-[500px] h-[500px] bg-purple-900/30 rounded-full blur-[120px] pointer-events-none"></div>
             <div class="absolute bottom-0 left-0 w-[600px] h-[600px] bg-blue-900/20 rounded-full blur-[150px] pointer-events-none"></div>

             <div class="max-w-6xl mx-auto relative z-10">
                
                <!-- HEADER & TOGGLE -->
                <div class="text-center mb-12 reveal-up">
                    <div class="inline-flex items-center gap-2 px-4 py-1.5 rounded-full border border-white/20 bg-white/5 backdrop-blur-md mb-6">
                        <i class="ph-fill ph-brain text-[#FF3B30] animate-pulse"></i>
                        <span class="text-xs font-bold uppercase tracking-widest text-white/80">Powered by Gemini 2.0</span>
                    </div>
                    <h2 class="font-display text-4xl md:text-7xl font-bold mb-8 text-white">AI Creative Suite</h2>
                    
                    <!-- Toggle Switch -->
                    <div class="inline-flex bg-white/10 p-1 rounded-full backdrop-blur-md border border-white/10 flex-wrap justify-center">
                        <button onclick="setLabMode('brand')" id="tab-brand" class="lab-tab active text-sm md:text-base">Brand Forge</button>
                        <button onclick="setLabMode('advisor')" id="tab-advisor" class="lab-tab text-sm md:text-base">Workflow Advisor</button>
                    </div>
                </div>

                <!-- MODE 1: BRAND FORGE -->
                <div id="mode-brand" class="transition-opacity duration-500">
                    <p class="text-gray-400 text-base md:text-lg max-w-2xl mx-auto leading-relaxed text-center mb-12">
                        Enter a business idea (e.g. "Cyberpunk Coffee Shop"). The AI will generate a complete brand identity: 
                        <span class="text-white font-bold">Logo, Name, Palette, Typography, and Lifestyle Imagery.</span>
                    </p>

                    <!-- Input Area -->
                    <div class="glass-panel-accent p-3 rounded-2xl flex flex-col md:flex-row gap-4 max-w-3xl mx-auto mb-16 shadow-2xl border border-white/10">
                        <input type="text" id="ai-prompt" placeholder="Describe your dream brand..." 
                               class="flex-1 bg-black/40 border border-white/10 rounded-xl px-6 py-4 text-white placeholder-gray-500 focus:border-white/50 focus:bg-black/60 transition-all outline-none">
                        <button onclick="generateBrandIdentity()" id="generate-btn" 
                                class="glowing-btn bg-white text-black font-bold uppercase tracking-wider px-10 py-4 rounded-xl hover:scale-[1.02] transition-transform flex items-center justify-center gap-2 whitespace-nowrap hover-trigger shadow-lg">
                            <i class="ph-bold ph-lightning"></i> Forge Brand
                        </button>
                    </div>

                    <!-- Output Area -->
                    <div id="ai-output" class="hidden animate-fade-in space-y-12">
                        <!-- Brand Identity Header -->
                        <div class="text-center">
                            <h3 id="brand-name" class="font-display text-5xl md:text-8xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-white via-gray-200 to-gray-500 mb-4 tracking-tight"></h3>
                            <p id="brand-tagline" class="text-lg md:text-2xl text-[#FF3B30] font-medium tracking-widest uppercase"></p>
                            <p id="brand-desc" class="text-gray-400 mt-6 max-w-2xl mx-auto italic border-l-2 border-white/20 pl-4"></p>
                        </div>

                        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                            <!-- Visual Assets Column (Left) -->
                            <div class="lg:col-span-5 space-y-8">
                                <!-- Logo Generator -->
                                <div class="glass-panel p-6 rounded-2xl border border-white/10">
                                    <div class="flex justify-between items-center mb-4">
                                        <h4 class="text-xs font-bold text-gray-500 uppercase tracking-widest flex items-center gap-2">
                                            <i class="ph-fill ph-vector-three"></i> Generated Logo Concept
                                        </h4>
                                    </div>
                                    <div id="logo-container" class="logo-container group relative">
                                        <div class="absolute inset-0 flex flex-col items-center justify-center text-gray-600 gap-2">
                                            <i class="ph-duotone ph-aperture text-4xl animate-spin"></i>
                                            <span class="text-xs">Generating Vector...</span>
                                        </div>
                                    </div>
                                    <p id="logo-text" class="text-xs text-gray-500 mt-4 leading-relaxed"></p>
                                </div>

                                <!-- Typography -->
                                <div class="glass-panel p-6 rounded-2xl border border-white/10">
                                    <h4 class="text-xs font-bold text-gray-500 uppercase tracking-widest mb-4">Typography System</h4>
                                    <div class="space-y-4">
                                        <div>
                                            <span class="text-xs text-gray-600 block mb-1">Display / Header</span>
                                            <p id="font-header" class="text-2xl text-white font-bold">Inter Tight</p>
                                        </div>
                                        <div>
                                            <span class="text-xs text-gray-600 block mb-1">Body / UI</span>
                                            <p id="font-body" class="text-base text-gray-300">Roboto Mono</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Atmosphere & Color (Right) -->
                            <div class="lg:col-span-7 space-y-8">
                                <!-- Moodboard Image -->
                                <div class="glass-panel p-2 rounded-2xl border border-white/10">
                                    <div class="generated-image-container h-[300px] md:h-[400px] w-full bg-black/50">
                                        <div id="mood-image-wrapper" class="w-full h-full flex items-center justify-center">
                                            <p class="text-xs text-gray-500 animate-pulse">Rendering Lifestyle Visualization...</p>
                                        </div>
                                    </div>
                                    <div class="p-4">
                                        <h4 class="text-xs font-bold text-gray-500 uppercase tracking-widest mb-1">Brand Atmosphere</h4>
                                        <p id="visual-style" class="text-sm text-gray-300"></p>
                                    </div>
                                </div>

                                <!-- Color Palette -->
                                <div class="glass-panel p-8 rounded-2xl border border-white/10">
                                    <h4 class="text-xs font-bold text-gray-500 uppercase tracking-widest mb-6">Color Palette</h4>
                                    <div id="ai-palette" class="grid grid-cols-2 md:grid-cols-5 gap-4"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- MODE 2: WORKFLOW ADVISOR (NEW) -->
                <div id="mode-advisor" class="hidden transition-opacity duration-500">
                    <p class="text-gray-400 text-lg max-w-2xl mx-auto leading-relaxed text-center mb-12">
                        Not sure which tool to use? Describe your creative goal (e.g., "Create a cinematic sci-fi intro") and I'll generate a custom **AI Workflow** for you.
                    </p>

                    <div class="glass-panel-accent p-3 rounded-2xl flex flex-col md:flex-row gap-4 max-w-3xl mx-auto mb-16 shadow-2xl border border-white/10">
                        <input type="text" id="advisor-prompt" placeholder="What do you want to create?" 
                               class="flex-1 bg-black/40 border border-white/10 rounded-xl px-6 py-4 text-white placeholder-gray-500 focus:border-white/50 focus:bg-black/60 transition-all outline-none">
                        <button onclick="generateWorkflow()" id="advisor-btn" 
                                class="glowing-btn bg-[#FF3B30] text-white font-bold uppercase tracking-wider px-10 py-4 rounded-xl hover:scale-[1.02] transition-transform flex items-center justify-center gap-2 whitespace-nowrap hover-trigger shadow-lg">
                            <i class="ph-bold ph-magic-wand"></i> Get Advice
                        </button>
                    </div>

                    <div id="advisor-output" class="hidden max-w-4xl mx-auto space-y-8 animate-fade-in">
                        <div class="glass-panel p-8 rounded-2xl border border-white/10">
                            <h3 class="text-2xl font-bold text-white mb-6 flex items-center gap-2"><i class="ph-fill ph-stack text-[#FF3B30]"></i> Recommended Workflow</h3>
                            <div id="advisor-steps" class="space-y-6">
                                <!-- Steps injected here -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Loading Overlay -->
                <div id="ai-loading" class="hidden py-24 text-center">
                    <div class="inline-block relative w-20 h-20">
                        <div class="absolute top-0 left-0 w-full h-full border-4 border-white/20 rounded-full"></div>
                        <div class="absolute top-0 left-0 w-full h-full border-4 border-t-[#FF3B30] rounded-full animate-spin"></div>
                    </div>
                    <h3 class="text-2xl font-bold mt-8 text-white">Processing Request...</h3>
                    <p class="text-sm text-gray-500 mt-2 animate-pulse" id="loading-text">Analyzing...</p>
                </div>

             </div>
        </section>

        <!-- CTA / Footer -->
        <section id="contact" class="min-h-screen flex flex-col justify-between pt-32 pb-12 px-6 md:px-12 relative overflow-hidden bg-[#0a0a0a]">
             <!-- Gradient Mesh Background for Footer -->
            <div class="absolute top-0 left-0 w-full h-full opacity-30 pointer-events-none">
                 <div class="absolute top-[20%] left-[20%] w-[40vw] h-[40vw] bg-purple-900 rounded-full blur-[120px]"></div>
                 <div class="absolute bottom-[20%] right-[20%] w-[30vw] h-[30vw] bg-blue-900 rounded-full blur-[100px]"></div>
            </div>

            <div class="z-10 max-w-4xl">
                <p class="text-gray-400 uppercase tracking-widest font-bold mb-8">What's Next?</p>
                <h2 class="font-display text-5xl md:text-8xl font-bold leading-none mb-12">
                    Let's work<br>together.
                </h2>
                <div class="flex flex-col md:flex-row gap-8">
                    <!-- UPDATED: Smart Email Button -->
                    <a href="mailto:njadaun72@gmail.com" onclick="handleEmailClick(event)" class="glass-panel px-8 py-4 rounded-full text-lg font-bold hover:bg-white hover:text-black transition duration-300 hover-trigger inline-flex items-center justify-center gap-3 cursor-pointer">
                        <i class="ph-bold ph-envelope-simple"></i> <span id="email-btn-text">njadaun72@gmail.com</span>
                    </a>
                    
                    <a href="https://api.whatsapp.com/send?phone=917976728896" target="_blank" rel="noopener noreferrer" class="glass-panel px-8 py-4 rounded-full text-lg font-bold hover:bg-[#25D366] hover:text-white transition duration-300 hover-trigger inline-flex items-center justify-center gap-3">
                        <i class="ph-bold ph-whatsapp-logo"></i> WhatsApp Me
                    </a>
                </div>
            </div>

            <div class="z-10 grid grid-cols-1 md:grid-cols-3 gap-8 pt-24 border-t border-white/10 mt-auto">
                <div>
                    <h4 class="font-bold mb-4 text-white">Navigation</h4>
                    <ul class="space-y-2 text-gray-500 text-sm">
                        <li><a href="#about" class="hover:text-white transition">About Me</a></li>
                        <li><a href="#work" class="hover:text-white transition">Portfolio</a></li>
                        <li><a href="#services" class="hover:text-white transition">Services</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="font-bold mb-4 text-white">Socials</h4>
                    <ul class="space-y-2 text-gray-500 text-sm">
                        <li><a href="https://www.behance.net/narendrajadaun" target="_blank" class="hover:text-[#0057ff] transition">Behance</a></li>
                        <li><a href="#" class="hover:text-pink-500 transition">Instagram</a></li>
                        <li><a href="#" class="hover:text-blue-500 transition">LinkedIn</a></li>
                    </ul>
                </div>
                <div class="md:text-right">
                    <p class="text-gray-500 text-sm">© 2025 Narendra Jadaun.<br>All rights reserved.</p>
                </div>
            </div>
        </section>

        <!-- CHATBOT WIDGET -->
        <div id="chat-widget">
            <div id="chat-window">
                <div class="p-4 border-b border-white/10 bg-white/5 flex justify-between items-center">
                    <div>
                        <h3 class="font-bold text-sm">Ask My AI</h3>
                        <p class="text-xs text-green-400 flex items-center gap-1"><span class="w-1.5 h-1.5 bg-green-400 rounded-full animate-pulse"></span> Online</p>
                    </div>
                    <button onclick="toggleChat()" class="text-gray-400 hover:text-white"><i class="ph-bold ph-x"></i></button>
                </div>
                <div id="chat-messages">
                    <div class="message bot">
                        Hello! I'm Narendra's AI Digital Twin. Ask me anything about his work, skills, or experience!
                    </div>
                </div>
                <div class="p-3 bg-white/5 border-t border-white/10 flex gap-2">
                    <input type="text" id="chat-input" placeholder="Type a message..." 
                           class="flex-1 bg-black/20 border border-white/10 rounded-lg px-3 py-2 text-sm text-white focus:border-white/40 outline-none"
                           onkeypress="if(event.key === 'Enter') sendMessage()">
                    <button onclick="sendMessage()" class="bg-white text-black w-9 h-9 rounded-lg flex items-center justify-center hover:bg-gray-200 transition">
                        <i class="ph-bold ph-paper-plane-right"></i>
                    </button>
                </div>
            </div>
            <button id="chat-toggle" onclick="toggleChat()" class="hover-trigger">
                <i class="ph-fill ph-chat-circle-dots"></i>
            </button>
        </div>

        <!-- Toast Element -->
        <div id="toast">
            <i class="ph-fill ph-check-circle text-[#25D366] text-xl"></i> 
            Email copied to clipboard!
        </div>

    </main>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
    <!-- UPDATED: Using CDNJS for Lenis for better stability -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lenis/1.0.42/lenis.min.js"></script>

    <script>
        // --- GEMINI API CONFIGURATION ---
        const apiKey = ""; // API Key injected by environment

        // --- API KEY HANDLING FOR LOCAL EXECUTION ---
        function getApiKey() {
            if (apiKey && apiKey !== "") return apiKey;
            
            // Check local storage for manually entered key
            let storedKey = localStorage.getItem("gemini_api_key");
            if (storedKey) return storedKey;
            
            // Prompt user
            let userKey = prompt("To use AI features locally, please enter your Google Gemini API Key (get one at aistudio.google.com):");
            if (userKey) {
                localStorage.setItem("gemini_api_key", userKey);
                return userKey;
            }
            return null;
        }

        // --- MOBILE MENU LOGIC ---
        function toggleMobileMenu() {
            const menu = document.getElementById('mobile-menu');
            const icon = document.getElementById('menu-icon');
            
            menu.classList.toggle('open');
            
            if (menu.classList.contains('open')) {
                icon.classList.remove('ph-list');
                icon.classList.add('ph-x');
            } else {
                icon.classList.remove('ph-x');
                icon.classList.add('ph-list');
            }
        }

        // --- EMAIL HANDLER ---
        function handleEmailClick(e) {
            const email = "njadaun72@gmail.com";
            
            // 1. Copy to Clipboard (using robust execCommand for iframes)
            const textArea = document.createElement("textarea");
            textArea.value = email;
            document.body.appendChild(textArea);
            textArea.select();
            
            try {
                document.execCommand('copy');
                const toast = document.getElementById("toast");
                toast.className = "show";
                setTimeout(function(){ toast.className = toast.className.replace("show", ""); }, 3000);
            } catch (err) {
                console.error('Copy failed', err);
            }
            document.body.removeChild(textArea);
        }

        // --- 0. VIDEO AUTOPLAY LOGIC (Robust) ---
        document.addEventListener('DOMContentLoaded', () => {
            const video = document.getElementById('ai-video');
            const overlay = document.getElementById('play-overlay');
            
            if (video) {
                // Initial Volume
                video.volume = 0.2;

                // Function to handle successful play
                const onPlay = () => {
                    if (overlay) overlay.style.opacity = '0';
                    setTimeout(() => { if(overlay) overlay.style.display = 'none'; }, 300);
                };

                // 1. Attempt Auto-Play
                const attemptPlay = async () => {
                    try {
                        video.muted = true; // Muted required for autoplay
                        await video.play();
                        onPlay();
                    } catch (err) {
                        console.warn("Autoplay blocked:", err);
                        if(overlay) overlay.style.opacity = '1';
                    }
                };
                
                attemptPlay();

                // 2. Manual Play Interaction
                if (overlay) {
                    overlay.addEventListener('click', () => {
                        video.muted = false; // Unmute on click
                        video.play();
                        onPlay();
                    });
                }

                // 3. Hover Interaction
                const container = video.parentElement;
                const enableAudio = () => {
                    if (!video.paused) {
                        video.muted = false;
                        video.volume = 0.2;
                    }
                };
                container.addEventListener('mouseenter', enableAudio);
                container.addEventListener('touchstart', enableAudio);
            }
        });

        // --- 1. PRELOADER & INTRO ANIMATION ---
        const counterElement = document.querySelector('.counter');
        const loaderProgress = document.querySelector('.loader-progress');
        const loader = document.querySelector('.loader');
        
        let count = 0;
        const updateCounter = () => {
            count += Math.floor(Math.random() * 5) + 1;
            if (count > 100) count = 100;
            
            counterElement.textContent = count;
            loaderProgress.style.width = `${count}%`;
            
            if (count < 100) {
                requestAnimationFrame(updateCounter);
            } else {
                // Intro Animation when loaded
                gsap.to(loader, {
                    yPercent: -100,
                    duration: 1.2,
                    ease: "power4.inOut",
                    delay: 0.5,
                    onComplete: initSiteAnimations
                });
            }
        };
        requestAnimationFrame(updateCounter);

        function initSiteAnimations() {
            // Hero Text Reveal using yPercent for better container handling
            gsap.from(".line-text", {
                yPercent: 100,
                duration: 1.5,
                stagger: 0.1,
                ease: "power4.out"
            });
            
            // Hero Content Fade In
            gsap.to('.reveal-up', {
                opacity: 1,
                y: 0,
                duration: 1,
                stagger: 0.2,
                ease: "power3.out",
                delay: 0.5
            });
        }

        // --- 2. SMOOTH SCROLL (Lenis) ---
        if (typeof Lenis !== 'undefined') {
            const lenis = new Lenis({
                duration: 1.2,
                easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)),
                direction: 'vertical',
                gestureDirection: 'vertical',
                smooth: true,
                mouseMultiplier: 1,
                smoothTouch: false,
                touchMultiplier: 2,
            });

            function raf(time) {
                lenis.raf(time);
                requestAnimationFrame(raf);
            }
            requestAnimationFrame(raf);
        } else {
            console.warn("Lenis library failed to load. Native scrolling enabled.");
        }

        // --- 3. CUSTOM MOUSE CURSOR ---
        const cursorDot = document.querySelector('.cursor-dot');
        const cursorOutline = document.querySelector('.cursor-outline');
        const hoverTriggers = document.querySelectorAll('.hover-trigger');

        window.addEventListener('mousemove', (e) => {
            const posX = e.clientX;
            const posY = e.clientY;

            // Dot follows instantly
            cursorDot.style.left = `${posX}px`;
            cursorDot.style.top = `${posY}px`;

            // Outline follows with lag using GSAP for better performance than .animate()
            gsap.to(cursorOutline, {
                left: posX,
                top: posY,
                duration: 0.2,
                ease: "power2.out"
            });
        });

        // Use event delegation for dynamically added elements (like AI results)
        document.body.addEventListener('mouseover', (e) => {
            if (e.target.closest('.hover-trigger')) {
                document.body.classList.add('hovering');
            }
        });
        document.body.addEventListener('mouseout', (e) => {
            if (e.target.closest('.hover-trigger')) {
                document.body.classList.remove('hovering');
            }
        });


        // --- 4. GSAP SCROLL ANIMATIONS ---
        gsap.registerPlugin(ScrollTrigger);

        // General Reveal for Sections
        const revealElements = document.querySelectorAll('.reveal-up');
        revealElements.forEach(element => {
            // Check if already visible from intro, otherwise add scroll trigger
            if(window.scrollY > 100 || element.closest('#ai-lab')) {
                 gsap.fromTo(element, 
                    { opacity: 0, y: 50 },
                    {
                        scrollTrigger: {
                            trigger: element,
                            start: "top 80%",
                            toggleActions: "play none none reverse"
                        },
                        opacity: 1,
                        y: 0,
                        duration: 1,
                        ease: "power3.out"
                    }
                );
            }
        });

        // Image Parallax Effect
        const images = document.querySelectorAll('img');
        images.forEach(img => {
            gsap.to(img, {
                yPercent: 15,
                ease: "none",
                scrollTrigger: {
                    trigger: img.parentElement,
                    start: "top bottom",
                    end: "bottom top",
                    scrub: true
                }
            });
        });

        // --- 5. THREE.JS BACKGROUND (Geometric Flow) ---
        const initThreeJS = () => {
            if (typeof THREE === 'undefined') return;

            const scene = new THREE.Scene();
            // Add slight fog for depth
            scene.fog = new THREE.FogExp2(0x050505, 0.002);

            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 5;

            const renderer = new THREE.WebGLRenderer({ alpha: true, antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);
            const container = document.getElementById('canvas-container');
            if (container) container.appendChild(renderer.domElement);

            // Particles Geometry
            const geometry = new THREE.BufferGeometry();
            const count = 3000;
            const positions = new Float32Array(count * 3);
            
            for (let i = 0; i < count; i++) {
                positions[i * 3] = (Math.random() - 0.5) * 20;
                positions[i * 3 + 1] = (Math.random() - 0.5) * 20;
                positions[i * 3 + 2] = (Math.random() - 0.5) * 20;
            }

            geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));

            // Material
            const material = new THREE.PointsMaterial({
                size: 0.02,
                color: 0xffffff,
                transparent: true,
                opacity: 0.8,
            });

            const particles = new THREE.Points(geometry, material);
            scene.add(particles);

            // Mouse interaction
            let mouseX = 0;
            let mouseY = 0;
            let targetX = 0;
            let targetY = 0;

            const windowHalfX = window.innerWidth / 2;
            const windowHalfY = window.innerHeight / 2;

            document.addEventListener('mousemove', (event) => {
                mouseX = (event.clientX - windowHalfX);
                mouseY = (event.clientY - windowHalfY);
            });

            const clock = new THREE.Clock();

            // Animation Loop
            const animate = () => {
                requestAnimationFrame(animate);

                targetX = mouseX * 0.001;
                targetY = mouseY * 0.001;

                particles.rotation.y += 0.001; // Constant rotation
                particles.rotation.x += 0.05 * (targetY - particles.rotation.x);
                particles.rotation.y += 0.05 * (targetX - particles.rotation.y);

                // Wave effect based on time
                const time = clock.getElapsedTime();
                
                // Simple gentle movement (No complex shader for stability)
                particles.position.y = Math.sin(time * 0.2) * 0.5;

                renderer.render(scene, camera);
            };

            animate();

            // Handle Resize
            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });
        };

        // Initialize Three.js after DOM is ready
        initThreeJS();

        // --- 6. GEMINI API INTEGRATIONS ---

        // MODE SWITCHER
        function setLabMode(mode) {
            document.querySelectorAll('.lab-tab').forEach(t => t.classList.remove('active'));
            document.getElementById(`tab-${mode}`).classList.add('active');
            
            document.getElementById('mode-brand').classList.add('hidden');
            document.getElementById('mode-advisor').classList.add('hidden');
            document.getElementById(`mode-${mode}`).classList.remove('hidden');
        }

        function switchToAdvisor() {
            document.getElementById('ai-lab').scrollIntoView({behavior: 'smooth'});
            setLabMode('advisor');
        }

        // A. TEXT GENERATION (Brand Architect)
        async function generateBrandIdentity() {
            const promptInput = document.getElementById('ai-prompt');
            const userIdea = promptInput.value.trim();
            const loading = document.getElementById('ai-loading');
            const output = document.getElementById('ai-output');
            const btn = document.getElementById('generate-btn');
            const logoContainer = document.getElementById('logo-container');
            const moodContainer = document.getElementById('mood-image-wrapper');
            const loadingText = document.getElementById('loading-text');

            if (!userIdea) {
                alert("Please enter a business idea first!");
                return;
            }

            const currentKey = getApiKey();
            if (!currentKey) {
                alert("AI API Key is missing! Please configure it.");
                return;
            }

            // UI State Reset
            loading.classList.remove('hidden');
            output.classList.add('hidden');
            btn.disabled = true;
            btn.classList.add('opacity-50');
            logoContainer.innerHTML = '<div class="flex flex-col items-center gap-2"><i class="ph-duotone ph-aperture text-4xl animate-spin text-gray-500"></i><span class="text-xs text-gray-500">Constructing Vector...</span></div>';
            moodContainer.innerHTML = '<p class="text-xs text-gray-500 animate-pulse">Rendering Lifestyle Visualization...</p>';

            // 1. STRATEGY GENERATION
            const systemPrompt = `
            You are an Award-Winning Brand Strategist & Creative Director.
            Generate a high-end, modern, and unique Brand Identity Package based on the user's concept.
            
            Return ONLY raw JSON with this exact schema:
            {
                "brandName": "String",
                "tagline": "String",
                "description": "String",
                "logoConcept": "String",
                "visualStyle": "String",
                "fontHeader": "String",
                "fontBody": "String",
                "colors": ["#hex", "#hex", "#hex", "#hex", "#hex"]
            }`;

            try {
                loadingText.innerText = "Consulting AI Strategy Engine...";
                
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${currentKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: `Business Concept: ${userIdea}` }] }],
                        systemInstruction: { parts: [{ text: systemPrompt }] },
                        generationConfig: { responseMimeType: "application/json" }
                    })
                });

                const data = await response.json();
                if (data.error) throw new Error(data.error.message);

                const result = JSON.parse(data.candidates[0].content.parts[0].text);

                // Populate UI
                document.getElementById('brand-name').innerText = result.brandName;
                document.getElementById('brand-tagline').innerText = result.tagline;
                document.getElementById('brand-desc').innerText = `"${result.description}"`;
                document.getElementById('logo-text').innerText = result.logoConcept;
                document.getElementById('font-header').innerText = result.fontHeader;
                document.getElementById('font-body').innerText = result.fontBody;
                document.getElementById('visual-style').innerText = result.visualStyle;

                // Populate Colors
                const paletteContainer = document.getElementById('ai-palette');
                paletteContainer.innerHTML = '';
                result.colors.forEach(color => {
                    const div = document.createElement('div');
                    div.className = 'color-swatch aspect-square rounded-full cursor-pointer relative group border border-white/10 shadow-lg';
                    div.style.backgroundColor = color;
                    div.onclick = () => {
                         const textArea = document.createElement("textarea");
                         textArea.value = color;
                         document.body.appendChild(textArea);
                         textArea.select();
                         document.execCommand('copy');
                         document.body.removeChild(textArea);
                         alert(`Color ${color} copied!`);
                    };
                    paletteContainer.appendChild(div);
                });

                // Show Text Results
                loading.classList.add('hidden');
                output.classList.remove('hidden');

                // 2. IMAGE GENERATION
                loadingText.innerText = "Rendering Visual Assets...";
                
                const logoPrompt = `High-quality vector logo icon for "${result.brandName}", concept: ${result.logoConcept}. Style: Minimalist, flat design, white background.`;
                const moodPrompt = `Editorial commercial photography for brand "${result.brandName}". Style: ${result.visualStyle}. Features: Cinematic lighting, 8k resolution.`;

                Promise.all([
                    generateImage(logoPrompt, logoContainer, true, currentKey),
                    generateImage(moodPrompt, moodContainer, false, currentKey)
                ]);

            } catch (error) {
                console.error("Brand Gen Error:", error);
                alert("AI Error: " + error.message);
                loading.classList.add('hidden');
            } finally {
                btn.disabled = false;
                btn.classList.remove('opacity-50');
            }
        }

        async function generateImage(prompt, container, isLogo, key) {
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/imagen-4.0-generate-001:predict?key=${key}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        instances: [{ prompt: prompt }],
                        parameters: { sampleCount: 1 }
                    })
                });
                
                const data = await response.json();
                
                if(data.predictions && data.predictions[0]) {
                    const base64 = data.predictions[0].bytesBase64Encoded;
                    const img = document.createElement('img');
                    img.src = `data:image/png;base64,${base64}`;
                    img.className = 'w-full h-full object-cover animate-fade-in';
                    if(isLogo) img.className += ' p-4';
                    
                    container.innerHTML = '';
                    container.appendChild(img);
                } else {
                    container.innerHTML = '<p class="text-xs text-red-400">Generation Unavailable</p>';
                }
            } catch(e) {
                console.error("Img Error", e);
                container.innerHTML = '<p class="text-xs text-red-400">Error</p>';
            }
        }

        // B. NEW: WORKFLOW ADVISOR
        async function generateWorkflow() {
            const input = document.getElementById('advisor-prompt').value;
            const output = document.getElementById('advisor-output');
            const stepsContainer = document.getElementById('advisor-steps');
            const btn = document.getElementById('advisor-btn');
            const loading = document.getElementById('ai-loading');
            const loadingText = document.getElementById('loading-text');

            if(!input) return alert("Please describe your goal.");

            const currentKey = getApiKey();
            if (!currentKey) return;

            loading.classList.remove('hidden');
            output.classList.add('hidden');
            loadingText.innerText = "Designing custom workflow...";
            btn.disabled = true;

            const prompt = `
            User Goal: "${input}"
            Role: You are Narendra Jadaun, a Senior Visual Designer.
            Expertise: Adobe Creative Suite, Midjourney, Runway Gen-2, Veo, Flow.
            
            Return ONLY raw JSON:
            {
                "steps": [
                    {"tool": "Tool Name", "action": "Instruction"}
                ]
            }`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${currentKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }],
                        generationConfig: { responseMimeType: "application/json" }
                    })
                });
                
                const data = await response.json();
                const result = JSON.parse(data.candidates[0].content.parts[0].text);
                
                stepsContainer.innerHTML = '';
                result.steps.forEach((step, index) => {
                    const html = `
                    <div class="flex gap-4">
                        <div class="flex-shrink-0 w-12 h-12 bg-white/10 rounded-full flex items-center justify-center border border-white/20 text-[#FF3B30] font-bold text-lg">
                            ${index + 1}
                        </div>
                        <div>
                            <h4 class="text-lg font-bold text-white mb-1">${step.tool}</h4>
                            <p class="text-gray-400 text-sm">${step.action}</p>
                        </div>
                    </div>`;
                    stepsContainer.innerHTML += html;
                });

                loading.classList.add('hidden');
                output.classList.remove('hidden');

            } catch(e) {
                console.error(e);
                alert("Advisor unavailable.");
                loading.classList.add('hidden');
            } finally {
                btn.disabled = false;
            }
        }

        // C. TEXT TO SPEECH
        async function playBioTTS() {
            const btn = document.querySelector('button[onclick="playBioTTS()"]');
            const icon = document.getElementById('tts-icon');
            const textEl = document.getElementById('tts-text');
            const bioText = "I don't just design; I engineer visual narratives. Currently a Senior Graphic Designer at Mittsure Technologies.";

            if (btn.classList.contains('playing')) return;

            const currentKey = getApiKey();
            if (!currentKey) return;

            icon.className = "ph-bold ph-spinner animate-spin text-lg";
            textEl.innerText = "Generating...";
            btn.classList.add('playing');

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-tts:generateContent?key=${currentKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: bioText }] }],
                        generationConfig: {
                            responseModalities: ["AUDIO"],
                            speechConfig: {
                                voiceConfig: {
                                    prebuiltVoiceConfig: {
                                        voiceName: "Puck"
                                    }
                                }
                            }
                        }
                    })
                });

                const data = await response.json();
                if (data.error) throw new Error(data.error.message);

                const audioData = data.candidates[0].content.parts[0].inlineData.data;
                playPCM(audioData);
                
                textEl.innerText = "Playing...";
                icon.className = "ph-fill ph-speaker-high text-lg text-accent";

            } catch (error) {
                console.error("TTS Error:", error);
                alert("Audio generation failed.");
                resetTTSButton();
            }
        }

        function resetTTSButton() {
            const btn = document.querySelector('button[onclick="playBioTTS()"]');
            if(!btn) return;
            const icon = document.getElementById('tts-icon');
            const textEl = document.getElementById('tts-text');
            btn.classList.remove('playing');
            icon.className = "ph-fill ph-speaker-high text-lg group-hover:text-accent transition-colors";
            textEl.innerText = "Listen to Bio ✨";
        }

        function playPCM(base64PCM) {
            const binaryString = window.atob(base64PCM);
            const len = binaryString.length;
            const bytes = new Uint8Array(len);
            for (let i = 0; i < len; i++) {
                bytes[i] = binaryString.charCodeAt(i);
            }
            const int16Array = new Int16Array(bytes.buffer);
            const float32Array = new Float32Array(int16Array.length);
            for (let i = 0; i < int16Array.length; i++) {
                float32Array[i] = int16Array[i] / 32768;
            }
            const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const buffer = audioCtx.createBuffer(1, float32Array.length, 24000);
            buffer.getChannelData(0).set(float32Array);
            const source = audioCtx.createBufferSource();
            source.buffer = buffer;
            source.connect(audioCtx.destination);
            source.start(0);
            source.onended = () => { resetTTSButton(); };
        }

        // --- D. CHATBOT FUNCTIONALITY ---
        let chatOpen = false;
        function toggleChat() {
            const window = document.getElementById('chat-window');
            chatOpen = !chatOpen;
            if(chatOpen) {
                window.classList.add('open');
                setTimeout(() => document.getElementById('chat-input').focus(), 300);
            } else {
                window.classList.remove('open');
            }
        }

        async function sendMessage() {
            const input = document.getElementById('chat-input');
            const text = input.value.trim();
            if(!text) return;

            const currentKey = getApiKey();
            if (!currentKey) return;

            input.value = '';
            addMessage(text, 'user');
            const loadingId = addMessage('Thinking...', 'bot', true);

            const systemPrompt = `You are the AI Digital Twin of Narendra Jadaun. Answer concisely.`;

            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${currentKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: text }] }],
                        systemInstruction: { parts: [{ text: systemPrompt }] }
                    })
                });

                const data = await response.json();
                const reply = data.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, I'm offline right now.";
                removeMessage(loadingId);
                addMessage(reply, 'bot');
            } catch (error) {
                console.error("Chat Error:", error);
                removeMessage(loadingId);
                addMessage("Error connecting to AI.", 'bot');
            }
        }

        function addMessage(text, sender, isLoading = false) {
            const container = document.getElementById('chat-messages');
            const div = document.createElement('div');
            div.className = `message ${sender}`;
            div.innerText = text;
            if(isLoading) {
                div.id = 'loading-msg';
                div.classList.add('animate-pulse');
            }
            container.appendChild(div);
            container.scrollTop = container.scrollHeight;
            return div.id;
        }

        function removeMessage(id) {
            const el = document.getElementById(id);
            if(el) el.remove();
        }

    </script>
</body>
</html>